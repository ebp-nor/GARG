HOWTO:
  distro:
    - question: >-
        What is the name of the Python distribution that runs in the
        browser?
      type: many_choice
      answers:
        - answer: PythonBrowser
          correct: false
          feedback: >-
            Hint: reread the text!
        - answer: Pyodide
          correct: true
  day:
    - question: What calendar day is it?
      type: numeric
      answers:
        - type: value
          correct: true
          feedback: correct
        - type: range
          correct: false
          range: [0, 31]
          feedback: >-
              Try again (hint: look at your calendar :-))


Workbook1A:
  tables:
    - question: >-
        What does each node (i.e. row of the node table) represent in tskit?
      type: many_choice
      answers:
        - answer: A diploid set of genomes
          correct: false
          feedback: >-
            Incorrect! A set of genomes is represented by a tskit "individual".
        - answer: A haploid genome
          correct: true
        - answer: A region of a haploid genome
          correct: false
          feedback: >-
            Incorrect! Nodes don't have any concept of genomic extent or length.
            That information is stored in the edges table. 
    - question: >-
        What does each edge (i.e. row of the edge table) represent in <em>tskit</em>?
      type: many_choice
      answers:
        - answer: A genealogical connection between a parent and a child individual
          correct: false
          feedback: >-
            Incorrect. A tskit edge connects *genomes* (nodes) not individuals.
        - answer: A genetic interval transmitted between ancestor and descendant nodes
          correct: true
          feedback: >-
            Correct! As well as a "parent" (ancestor) and "child" (descendant) node, each tskit edge
            specifies a left and right coordinate, representing a genomic interval.
        - answer: A coalescent event
          correct: false
        - answer: The boundaries of a tree sequence
          correct: false
  nodes_table:
    - question: What is the ID of the individual associated with node 15
      type: numeric
      answers:
        - type: value
          correct: true
          value: 7
          feedback: >-
            Correct: this is not the same as the node ID
        - type: default
          feedback: >-
            Incorrect, try again.
    - question: What is the ID of the population associated with the nodes, and what does it indicate?
      type: many_choice
      answers:
        - answer: "0"
          correct: false
          feedback: Incorrect
        - answer: "-1, indicating that the population is undefined or unknown"
          correct: true
          feedback: >-
            Correct! In tskit, an index value of "-1" indicates "NULL" (i.e. undefined)
        - answer: "-1, indicating the last population in the populations table"
          correct: false
          feedback: Incorrect
  array_access:
    - question: What is the child node ID of the last edge
      type: numeric
      answers:
        - type: value
          correct: true
          value: 24
          feedback: correct
        - type: default
          feedback: >-
            Incorrect, try again (hint, use ts.edges_child)
  simplified_tree_MRCA:
    - question: What is the node ID of the MRCA of samples 0 and 3?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 27
          feedback: Correct

Workbook1B:
  tree:
    - question: >-
       In the summary, what is the total branch length of this tree?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 155
          feedback: Correct
  expected_tmrca:
    - question: >-
        What is the expected mean TMRCA value (given that the diploid population size N=10 above)?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 20
          feedback: Correct. This should be quite close to the observed mean
  Human_Ne_TRMCA:
    - question: Assuming panmixis, an effective population size of 15 000, and a generation time of 27 years,
        what is the expected average divergence time between 2 human genomes?
      type: many_choice
      answers:
        - answer: "~30 000 generations"
          correct: true
          feedback: >-
            Yes, it's simply twice the diploid population size.
        - answer: "~810 000 years"
          correct: true
          feedback: >-
            Correct, assuming a generation time of 27 years (as per recent studies).  
        - answer: "~30 000 years"
          correct: false
          feedback: >-
            Thirty-thousand is the expected number of generations (as per the Wright-Fisher model).
        - answer: "~15 000 generations"
          correct: false
          feedback: >-
            The expected TMRCA is twice the effective population size.
    - question: Why might it be problematic to quote a single effective population size (Ne)?
      type: many_choice
      answers:
        - answer: "Ne is usually much larger than the census population size"
          correct: false
          feedback: >-
            Incorrect. If anything, the opposite is true. Nevertheless a common misconception is
            to interpret Ne as similar to the census population size, although the two are not directly comparable.
        - answer: "The human population size has been extremely variable over time"
          correct: true
          feedback: >-
            Correct. A single number is unlikely to capture the complexity of human demographic change.
        - answer: "Changes in population subdivision can cause changes in apparent Ne over time"
          correct: true
          feedback: >-
            Correct. Later we will use the more accurate 'inverse instantaneous coalescent rate' (IICR) instead,
            to avoid implying that changes may be caused by changes in population size.
        - answer: "Humans are not panmictic"
          correct: false
          feedback: >-
            It's true that humans are not panmictic, but Ne is simply meant to compare to an equivalent panmictic population.
  Human_mu_TRMCA:
    - question: How many sample nodes (sample genomes) are there in the tree sequence?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 6404
          feedback: Correct. There are more than a thousand genomes in the TGP dataset.
    - question: How many individuals are there in the tree sequence?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 3202
          feedback: Correct.
    - question: What is the estimated average TMRCA for this 5MB section of genome, to the nearest 10 thousand years?
      type: numeric
      precision: 2
      answers:
        - type: value
          correct: true
          value: 992789
          feedback: Correct.
        - type: value
          correct: true
          value: 990000
          feedback: Correct.
  mean_tmrca:
    - question: The mean TMRCA for n=2 samples is twice the population size. The root_time above measures the TMRCA for n=40 samples.
        What is a reasonable approximation for the mean TMRCA in this case (i.e. as n gets large)
      type: many_choice
      answers:
        - answer: "roughly 4 times the population size"
          correct: true
          feedback: >-
            Yes: this is the expected value as the number of samples tends to infinity. In other words
            as you increase the number of samples past 2, you only expect to double the mean TMRCA.
        - answer: "roughly the same as the population size"
          correct: false
          feedback: >-
            Incorrect: as you increase the number of samples, the mean MRCA for all samples should increase
        - answer: "roughly 40 times the population size"
          correct: false
        - answer: "As n increases to infinity, the mean TMRCA will also increase to infinity"
          correct: false
          feedback: >-
            Incorrect: the mean TMRCA increases, but rapidly approaches a limit.
  additional_samples:
    - question: Coalescent nodes are the main source of genetic information about historical processes. Which of the following is true?
      type: many_choice
      answers:
        - answer: "A small sample of DNA sequences will mostly contain information about the distant past (of the order of Ne
 generations ago)"
          correct: true
          feedback: Correct
        - answer: "To analyse the distant past in more detail is likely to require more genetic data from the same individuals (e.g. whole genome data), rather than data from more samples"
          correct: true
          feedback: Correct
        - answer: "Adding more individuals to a dataset will tend to add more and more information about the recent, rather than the distant past"
          correct: true
          feedback: Correct
        - answer: "Adding more samples to a genetic dataset is particularly useful in illuminating the distant past"
          correct: false
          feedback: "Incorrect: adding more samples tends to add more information about the recent, not distant past"

Workbook1C:
  low_rec_breaks:
    - question: >-
        How many recombination events are there in the low recombination example?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 1
          feedback: correct
        - type: default
          feedback: >-
            Try again (hint, how many unique left and right values are there?)
    - question: >-
        Where is the position of the breakpoint?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 79
          feedback: correct
        - type: default
          feedback: >-
            Try again
    - question: >-
        How many edges are broken up (start or end at) the breakpoint?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 4
          feedback: correct
        - type: default
          feedback: >-
            Try again
  high_rec_questions:
    - question: >-
        How many local trees are there in the original high recombination simulation?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 15
          feedback: correct
        - type: default
          feedback: >-
            Try again (hint, use ts_high_recomb.num_trees)
    - question: >-
        How many local trees are there in the simplified high recombination simulation?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 9
          feedback: correct
        - type: default
          feedback: >-
            Try again (hint, use ts_high_recomb.simplify().num_trees)
    - question: >-
        What is the MRCA of all the samples at the first genomic position?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 38
          feedback: correct
        - type: default
          feedback: >-
            Try again (hint, look at the top node in the first local tree)
  simplification_nodes:
    - question: >-
        In the first two graphs (levels 1 and 2), which nodes capture recombination events (i.e. have multiple parents)?
      type: many_choice
      answers:
        - answer: "23"
          correct: true
          feedback: Correct
        - answer: "15"
          correct: true
          feedback: Correct
        - answer: "38"
          correct: false
          feedback: Incorrect
        - answer: "25"
          correct: false
          feedback: Incorrect
        - answer: "67"
          correct: false
          feedback: Incorrect
        - answer: "58"
          correct: false
          feedback: Incorrect
    - question: >-
        In the level 4 graph, which nodes capture recombination events (i.e. have multiple parents)?
      type: many_choice
      answers:
        - answer: "4"
          correct: true
          feedback: Correct
        - answer: "10"
          correct: true
          feedback: Correct
        - answer: "38"
          correct: false
          feedback: Incorrect
        - answer: "25"
          correct: false
          feedback: Incorrect
        - answer: "67"
          correct: false
          feedback: Incorrect
        - answer: "58"
          correct: false
          feedback: Incorrect
  locally_coalescent:
    - question: >-
        Which level of simplification creates all local trees with only coalescent nodes?
      type: many_choice
      answers:
        - answer: "Full simplification (level 5)"
          correct: true
          feedback: Correct
        - answer: "Removing non-coalescent nodes (level 4)"
          correct: false
          feedback: "Incorrect: this removes nodes which are not coalescent anywhere, but retains 'locally unary' tree nodes (i.e. trees in which some nodes have only one child)"
        - answer: "Sample-resolve only"
          correct: false
          feedback: Incorrect
  backward_time:
    - question: >-
        What are the main advantage for simulating backward-in-time?
      type: many_choice
      answers:
        - answer: "You can efficiently simulate a smaller sample from a large population"
          correct: true
          feedback: Correct
        - answer: "You avoid the need to simulate lineages that go extinct"
          correct: true
          feedback: Correct
        - answer: "You can easily simulate selection"
          correct: false
          feedback: "Incorrect: simulate is hard to simulate backward-in-time"
        - answer: "You can ensure that all sample nodes coalescence"
          correct: true
          feedback: "Correct. In a ARG we usually only need to make sure that LOCAL coalescence is reached (i.e. that each local tree has a single root)"
  large_sim:
    - question: >-
        It shouldn't have taken that long to simulate a million 1Mb genomes. Roughly how much space is taken up by the resulting tree sequence?
      type: many_choice
      answers:
        - answer: "About 150MB"
          correct: true
          feedback: Correct
        - answer: "About 1GB"
          correct: false
          feedback: "Incorrect"
        - answer: "About 150GB"
          correct: false
          feedback: Incorrect
  diamonds:
    - question: >-
        How many "diamonds" are there in the msprime-simulated "full ARG" above?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 3
          feedback: Correct
        - type: default
          feedback: >-
            Incorrect: look at the number of self-contained "loops"
    - question: >-
        How many "super diamonds" are there in the msprime-simulated "full ARG" above?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 0
          feedback: Correct
        - type: default
          feedback: >-
            Incorrect: (a bit of a trick question, as there aren't any here)"

Workbook1D:
  sites_and_mutations:
    - question: >-
        What is the position of the first site.
      type: numeric
      answers:
        - type: value
          correct: true
          value: 3
          feedback: correct
        - type: default
          feedback: >-
            Try again (it's the site with ID=0)
    - question: >-
        How many mutations at this site?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 1
          feedback: "Correct. It's possible to have more than one mutatation, but it's unlikely"
        - type: default
          feedback: "Incorrect"
    - question: >-
        Which node is the mutation above?
      type: numeric
      answers:
        - type: value
          correct: true
          value: 12
          feedback: Correct.
    - question: >-
        Which sample nodes have inherited an A at the first variable site?
      type: many_choice
      answers:
        - answer: "Nodes 7, 8, and 9"
          correct: true
          feedback: >-
            Correct: they lie under the mutation on the tree.
        - answer: "Nodes 0, 3, and 6"
          correct: false
        - answer: "Node 17 only"
          correct: false
  last_haplotype:
    - question: >-
        What is the allele at the last position of sample node 9?
      type: many_choice
      answers:
        - answer: "T"
          correct: true
          feedback: >-
            Correct.
        - answer: "A"
          correct: false
        - answer: "C"
          correct: false
        - answer: "G"
          correct: false
  diversity:
    - question: >-
        What is the average sitewise diversity of this swept tree sequence (to 3 sig figures)?
      type: numeric
      precision: 6
      answers:
        - value: 0.000356
          correct: true
          feedback: Correct.
  mut_rate:
    - question: >-
        Which plotted mutation rate is closest to the branch length diversity?
      type: many_choice
      answers:
        - answer: "1e-7"
          correct: true
          feedback: >-
            Correct: the higher the mutation rate, the closer the site statistics are to the branch-length equivalents.
        - answer: "1e-8"
          correct: false
        - answer: "1e-9"
          correct: false
        - answer: "1e-10"
          correct: false
  Fst:
    - question: >-
        What is the site-based Fst between populations 0 and 3, to 4 decimal places?
      type: numeric
      precision: 4
      answers:
        - value: 0.0253
          correct: true
          feedback: Correct.
    - question: >-
        What is the branch-based Fst between populations 0 and 3, to 4 decimal places?
      type: numeric
      precision: 4
      answers:
        - value: 0.0266
          correct: true
          feedback: Correct.
  multiple_muts:
    - question: >-
        The last variable site has been highlighted in red, How many mutations are there at this site?
      type: numeric
      answers:
        - value: 3
          correct: true
          feedback: Correct.
    - question: >-
        What allele does sample node 1 have at the last variable site?
      type: many_choice
      answers:
        - answer: "C"
          correct: true
          feedback: >-
            Correct.
        - answer: "A"
          correct: false
        - answer: "T"
          correct: false
        - answer: "G"
          correct: false


Workbook1E:
  gnn:
    - question: |
        What are the GNN proportions of sample 3?
      type: many_choice
      answers:
        - answer: "100% CEU (orange)"
          correct: false
        - answer: "100% YRI (blue)"
          correct: false
        - answer: "50% CEU (orange), 50% YRI (blue)"
          correct: true
          feedback: |
            Correct! The genealogical nearest neighbors correspond to
            the *sample* nodes 8 and 19 descending from the nearest
            parent node, node 25356. Node 16041 is an internal node
            and does not contribute to the GNN.
  gnn_summary:
    - question: |
        What is the summary of GNN proportions for YRI (blue) and CEU
        (orange)?
      type: many_choice
      answers:
        - answer: |
            CEU has 100% YRI, 0% CEU, 0% CHB. YRI has 25% YRI, 75% CEU,
            0% CHB.
          correct: true
          feedback: |
            Correct! CEU only has one sample (19) which has one YRI
            neigbour (node 8). YRI node 8 has 100% CEU GNN (node 19)
            and node 3 has 50/50/0 YRI/CEU/CHB; averaging these
            numbers gives the 25/75/0 proportion. Note that this means
            the GNN metric is asymmetrical. In this particular case,
            CEU has 100% YRI neighbours, whereas YRI has a mix of CEU
            and YRI.
        - answer: |
            CEU has 50% YRI, 50% CEU, 0% CHB. YRI has 50% YRI, 50%
            CEU, 0% CHB.
          correct: false

Workbook2A:

